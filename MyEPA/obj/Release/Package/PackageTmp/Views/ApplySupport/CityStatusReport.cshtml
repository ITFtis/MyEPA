@model IEnumerable<MyEPA.ViewModels.ApplySupportCityStatusCountViewModel>
@using MyEPA.Models
@{
    ViewBag.Title = "請求支援統計";
    Layout = "~/Views/_Layout.cshtml";
    int diasterId = ViewBag.DiasterId;
    List<DiasterModel> diasters = ViewBag.Diasters;
}
<h2>@ViewBag.Title</h2>
@using (Html.BeginForm("CityStatusReport", "ApplySupport", new { }, FormMethod.Get, new { }))
{
    <table border="0">
        <tbody>
            <tr>
                <td><h5>災害名稱：</h5></td>
                <td>
                    <select name="diasterId" onchange="Change(this)">
                        @foreach (var item in diasters)
                        {
                            <option value="@item.Id" @(item.Id == diasterId ? "selected" : string.Empty)>@item.DiasterName</option>
                        }
                    </select>
                </td>
            </tr>

        </tbody>
    </table>
}
<table class="table">
    <tr style="color:White;background-color:#9AAC95;border-color:Black;font-size:Small;font-weight:bold;white-space:nowrap;">
        <th rowspan="2">縣市<br>名稱</th>
        <th colspan="3">人力支援(人天)</th>
        <th colspan="3">車輛設備(輛)</th>
        <th colspan="3">環境消毒設備(台)</th>
        <th colspan="3" style="width:18%;">環境消毒藥劑(公升)</th>
        <th colspan="3">請求補助款(元)</th>
        <th colspan="3">其他(項)</th>
        <th rowspan="2">環保署<br>補助<br>金額</th>
    </tr>
    <tr style="color:White;background-color:#9AAC95;border-color:Black;font-size:Small;font-weight:bold;white-space:nowrap;">
        <th scope="col">原請<br>求量</th>
        <th scope="col">局<br>核定</th>
        <th scope="col">署<br>核定</th>
        <th scope="col">原請<br>求量</th>
        <th scope="col">局<br>核定</th>
        <th scope="col">署<br>核定</th>
        <th scope="col">原請<br>求量</th>
        <th scope="col">局<br>核定</th>
        <th scope="col">署<br>核定</th>
        <th scope="col">原請<br>求量</th>
        <th scope="col">局<br>核定</th>
        <th scope="col">署<br>核定</th>
        <th scope="col">原請<br>求量</th>
        <th scope="col">局<br>核定</th>
        <th scope="col">署<br>核定</th>
        <th scope="col">原請<br>求量</th>
        <th scope="col">局<br>核定</th>
        <th scope="col">署<br>核定</th>
    </tr>
    <tr>
        <td>
            合計
        </td>
        <td>
            @Model.Sum(e => e.ApplyPeopleCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyPeopleEpbConfrimCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyPeopleEpaConfrimCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyCarCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyCarEpbConfrimCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyCarEpaConfrimCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyDisinfectionEquipmentCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyDisinfectionEquipmentEpbConfrimCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyDisinfectionEquipmentEpaConfrimCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyMedicineCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyMedicineEpbConfrimCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyMedicineEpaConfrimCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplySubsidyCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplySubsidyEpbConfrimCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplySubsidyEpaConfrimCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyOtherCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyOtherEpbConfrimCount)
        </td>
        <td>
            @Model.Sum(e => e.ApplyOtherEpaConfrimCount)
        </td>
        <td>
            @Model.Sum(e => e.Money)
        </td>
    </tr>
    @foreach (var item in Model)
    {
        <tr>
            <td>
                <a href="@Url.Action("TownStatusReport", "ApplySupport", new { diasterId, cityId = item.CityId })">@item.CityName</a>
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyPeopleCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyPeopleEpbConfrimCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyPeopleEpaConfrimCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyCarCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyCarEpbConfrimCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyCarEpaConfrimCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyDisinfectionEquipmentCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyDisinfectionEquipmentEpbConfrimCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyDisinfectionEquipmentEpaConfrimCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyMedicineCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyMedicineEpbConfrimCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyMedicineEpaConfrimCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplySubsidyCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplySubsidyEpbConfrimCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplySubsidyEpaConfrimCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyOtherCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyOtherEpbConfrimCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ApplyOtherEpaConfrimCount)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Money)
            </td>
        </tr>
    }

</table>

@section Scripts{
    <script>
        function Change(target)
        {
            window.location = '@Html.Raw(Url.Action("CityStatusReport","ApplySupport"))'+ `?diasterId=${target.value}`
        }
    </script>

}